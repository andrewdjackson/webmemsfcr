import {describe, it, expect} from "@jest/globals";
import * as Constant from "./analysis-constants.js";
import {Lambda, LAMBDA_FAULTY, LAMBDA_WORKING, LAMBDA_HEATER_WORKING, LAMBDA_HEATER_FAULTY} from "./lambda.js";
import {DataframeLog} from "../rosco/mems-dataframe-log.js";
import {createValidDataframe} from "../fixtures/test.fixtures.js";
import {getDateTimeString} from "../rosco/mems-dataframe.js";

describe('lambda', () => {
    it('oscillating as expected', () => {
        const lambdaProfile = [Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 420, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, 440, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, 440, 440, 440, 440, 445, 445, 450, 455, 455, 465, 470, 475, 485, 495, 505, 515, 530, 540, 555, 570, 590, 605, 625, 640, 660, 675, 680, 660, 650, 635, 605, 550, 535, 425, 445, 405, 330, 285, 255, 240, 225, 210, 190, 190, 250, 330, 520, 345, 265, 505, 390, 505, 400, 215, 235, 410, Constant.LAMBDA_DEFAULT_VOLTAGE, 270, 540, 335, 270, 370, 535, 560, 295, 530, 400, 355, 320, 335, 300, 295, 285, 555, 345, 385, 390, 390, 320, 170, 365, 320, 370, 535, 500, 340, 455, 555, 240, 290, Constant.LAMBDA_DEFAULT_VOLTAGE, 305, 475, 165, 570, 270, 600, 165, 180, 775, 775, 905, 880, 160, 405, 130, 135, 220, 180, 170, 150, 215, 210, 275, 470, 580, 180, 550, 265, 325, 525, 600, 770, 585, 345, 180, 815, 690, 155, 570, 200, 880, 910, 620, 305, 220, 790, 475, 405, 255, 465, 460, 115, 790, 640, 275, 400, 280, 365, 745, 540, 405, 550, 300, 330, 160, 325, 160, 255, 415, 225, 265, 695, 250, 665, 500, 695, 555, 165, 430, 660, 615, 595, 660, 235, 735, 365, 205, 685, 325, 200, 230, 785, 400, 175, 300, 185, 220, 300, 575, 225, 530, 150, 685, 320, 650, 135, 290, 445, 175, 370, 295, 530, 320, 280, 405, 470, 610, 265, 265, 370, 730, 515, 470, 575, 375, 390, 520, 705, 470, 245, 625, 675, 375, 590, 675, 390, 230, 125, 165, 605, 220, 535, 385, 295, 740, 645, 570, 460, 165, 585, 550, 555, 265, 420, 135, 740, 90, 260, 690, 290, 295, 405, 675, 585, 315, 570, 290, 740, 205];
        const dataframes = createDataframesWithLambdaProfile(lambdaProfile);
        const lambda = new Lambda(dataframes);
        expect(lambda.isOscillating()).toBe(LAMBDA_WORKING);
        expect(lambda.isHeaterFaulty()).toBe(LAMBDA_HEATER_WORKING);
    })

    it('no oscillations', () => {
        const lambdaProfile = [Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE];
        const dataframes = createDataframesWithLambdaProfile(lambdaProfile);
        const lambda = new Lambda(dataframes);
        expect(lambda.isOscillating()).toBe(LAMBDA_FAULTY);
        expect(lambda.isHeaterFaulty()).toBe(LAMBDA_HEATER_FAULTY);
    })

    it('not enough time to diagnose', () => {
        const lambdaProfile = [Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE];
        const dataframes = createDataframesWithLambdaProfile(lambdaProfile);
        const lambda = new Lambda(dataframes);
        expect(lambda.isOscillating()).toBe(LAMBDA_WORKING);
        expect(lambda.isHeaterFaulty()).toBe(LAMBDA_HEATER_WORKING);
    })

    it('heater issue, late oscillations', () => {
        const lambdaProfile = [Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 420, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, 440, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, Constant.LAMBDA_DEFAULT_VOLTAGE, 440, 440, 440, 440, 440, 445, 445, 450, 455, 455, 465, 470, 475, 485, 495, 505, 515, 530, 540, 555, 570, 590, 605, 625, 640, 660, 675, 680, 660, 650, 635, 605, 550, 535, 425, 445, 405, 330, 285, 255, 240, 225, 210, 190, 190, 250, 330, 520, 345, 265, 505, 390, 505, 400, 215, 235, 410, Constant.LAMBDA_DEFAULT_VOLTAGE, 270, 540, 335, 270, 370, 535, 560, 295, 530, 400, 355, 320, 335, 300, 295, 285, 555, 345, 385, 390, 390, 320, 170, 365, 320, 370, 535, 500, 340, 455, 555, 240, 290, Constant.LAMBDA_DEFAULT_VOLTAGE, 305, 475, 165, 570, 270, 600, 165, 180, 775, 775, 905, 880, 160, 405, 130, 135, 220, 180, 170, 150, 215, 210, 275, 470, 580, 180, 550, 265, 325, 525, 600, 770, 585, 345, 180, 815, 690, 155, 570, 200, 880, 910, 620, 305, 220, 790, 475, 405, 255, 465, 460, 115, 790, 640, 275, 400, 280, 365, 745, 540, 405, 550, 300, 330, 160, 325, 160, 255, 415, 225, 265, 695, 250, 665, 500, 695, 555, 165, 430, 660, 615, 595, 660, 235, 735, 365, 205, 685, 325, 200, 230, 785, 400, 175, 300, 185, 220, 300, 575, 225, 530, 150, 685, 320, 650, 135, 290, 445, 175, 370, 295, 530, 320, 280, 405, 470, 610, 265, 265, 370, 730, 515, 470, 575, 375, 390, 520, 705, 470, 245, 625, 675, 375, 590, 675, 390, 230, 125, 165, 605, 220, 535, 385, 295, 740, 645, 570, 460, 165, 585, 550, 555, 265, 420, 135, 740, 90, 260, 690, 290, 295, 405, 675, 585, 315, 570, 290, 740, 205];
        const dataframes = createDataframesWithLambdaProfile(lambdaProfile);
        const lambda = new Lambda(dataframes);
        expect(lambda.isOscillating()).toBe(LAMBDA_WORKING);
        expect(lambda.isHeaterFaulty()).toBe(LAMBDA_HEATER_FAULTY);
    })
})

function createDataframesWithLambdaProfile(profile) {
    let dataframeLog = new DataframeLog();

    for (let i = 0; i < profile.length; i++) {
        let df = createValidDataframe();
        df.df7d._7Dx06_LambdaVoltage = profile[i];
        df.df80._80x00_Time = getDateTimeString(i * 1000); // dataframes at 1 second intervals
        df.df7d._7Dx00_Time = df.df80._80x00_Time;

        dataframeLog.addDataframe(df.df7d);
        dataframeLog.addDataframe(df.df80);
    }

    return dataframeLog.dataframes;
}