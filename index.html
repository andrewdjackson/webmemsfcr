<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
</head>
<body>
<button onclick="connect()">Connect</button>
<button onclick="disconnect()">Disconnect</button>
<button onclick="getdataframe()">Dataframe</button>
<span><input id="command"><button onclick="sendCommand()">Send</button></span>

<script type="module">
	//import { MemsSerialInterface } from "./static/scripts/rosco/mems-serial.js"
	import {MemsEcu16} from "./static/scripts/rosco/mems-ecu16.js";
	import {EventQueue} from "./static/scripts/rosco/mems-queue.js";

	var q = new EventQueue();
	var m = new MemsEcu16(q);

	window.connect=()=> {
		m.Connect()
			.then((result) => {
				console.log(`index.html: connect ${result}`);
			})
			.catch((error) => {
				console.error(`index.html: connect ${error}`);
			});
	}

	window.disconnect=()=> {
		m.Disconnect()
			.then((result) => {
					console.log(`index.html: disconnected (connected ${result})`);
			})
			.catch((error) => {
				console.error(`index.html: disconnect ${error}`);
			});
	}

	window.getdataframe=()=> {
		m.GetDataframes(receivedDataframe);
	}

	window.sendCommand=()=> {
		let command = parseInt(document.getElementById("command").value, 16);
		m.SendAndReceive(command, 100);
	}

	function receivedDataframe() {
		console.log(`received dataframe`);
	}
</script>
</body>
</html>
